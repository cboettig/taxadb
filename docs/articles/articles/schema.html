<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Database schema for taxald • taxald</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Database schema for taxald">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">taxald</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/articles/crosswalk.html">Crosswalking The Authorities</a>
    </li>
    <li>
      <a href="../../articles/articles/schema.html">Database schema for taxald</a>
    </li>
    <li>
      <a href="../../articles/articles/taxald.html">taxald overview</a>
    </li>
    <li>
      <a href="../../articles/intro.html">Quickstart for taxald</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/cboettig/taxald">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Database schema for taxald</h1>
                        <h4 class="author">Carl Boettiger</h4>
            
            <h4 class="date">2018-12-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/cboettig/taxald/blob/master/vignettes/articles/schema.Rmd"><code>vignettes/articles/schema.Rmd</code></a></small>
      <div class="hidden name"><code>schema.Rmd</code></div>

    </div>

    
    
<p><code>taxald</code> relies on a set of pre-assembled tables following a set of standardized schema layouts outlined below. The database dumps provided by authorities supported in <code>taxald</code> at this time are:</p>
<ul>
<li>
<code>itis</code>: <a href="https://www.itis.gov/">The Integrated Taxonomic Information System</a>
</li>
<li>
<code>col</code>: <a href="http://www.catalogueoflife.org/">The Catalogue of Life</a>
</li>
<li>
<code>ncbi</code>: <a href="https://www.ncbi.nlm.nih.gov/">The National Center for Biotechnology Information</a>
</li>
<li>
<code>gbif</code>: <a href="https://www.gbif.org/">The Global Biodiversity Information Facility</a>
</li>
<li>
<code>tpl</code>: <a href="http://www.theplantlist.org/">The Plant List</a>
</li>
<li>
<code>fb</code>: <a href="https://fishbase.ca">FishBase</a>
</li>
<li>
<code>slb</code>: <a href="https://www.sealifebase.ca/">SeaLifeBase</a>
</li>
<li>
<code>wd</code>: <a href="https://wikidata.org">WikiData</a>
</li>
</ul>
<p>These authorities provide taxonomic data in a wide range of database formats using a wide range of data layouts (schemas), not all of which are particularly easy to use or interpret (e.g. hierarchies are often but not always specified in <code>taxon_id,parent_id</code> pairs.) To make it faster and easier to work across these authorities, <code>taxald</code> defines a common set of table schemas outlined below that are particularly suited for efficient computation of common tasks. <code>taxald</code> pre-processes and publicly archives compressed, flat tables corresponding to each of these schema for each of these authorities.</p>
<p>Using the schema defined below, most common operations can be expressed in terms of very standard operations, such as simple filtering joins in SQL. to implement these, <code>taxald</code> imports the compressed flat files into a local, column-oriented database, <a href=""><code>MonetDBLite</code></a>, which can be installed entirely as an R package with no additional server setup required. This provides a persistant store, and ensures that operations can be performed on disk since the taxonomic tables considered here are frequently too large to store in active memory. The columnar structure enables blazingly fast joins. Once the database is created, <code>taxald</code> simply wraps a set of user-friendly R functions around common <code>SQL</code> queries, implemented in the popular <code>dplyr</code> syntax. By default, <code>taxald</code> will always collect the results of these queries to return familiar, in-memory objects to the R user. Optional arguments allow more direct access the database queries.</p>
<p>This vignette summarizes the table schema defined by <code>taxald</code>. Pre-processing of the original database dumps from each authority into the format described here can be found in the corresponding scripts in <code>data-raw</code> directory of the R package source code.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(taxald)
<span class="kw"><a href="../../reference/td_create.html">td_create</a></span>(<span class="st">"all"</span>)</code></pre></div>
<div id="taxonid-schema" class="section level2">
<h2 class="hasAnchor">
<a href="#taxonid-schema" class="anchor"></a>taxonid schema</h2>
<p>A taxonid schema is provided for every authority, containing the columns:</p>
<ul>
<li>
<code>id</code>: a unique id for the name (including authority prefix)</li>
<li>
<code>name</code>: a Latin name (either accepted or known synonym)</li>
<li>
<code>rank</code>: the rank (as given by the authority)</li>
<li>
<code>accepted_id</code> the accepted id; (for synonyms, otherwise identical to the <code>id</code> for accepted names)</li>
</ul>
<p>Some authorities may report additional optional columns, such as the <code>update_date</code>, <code>name_type</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../../reference/taxa_tbl.html">taxa_tbl</a></span>(<span class="st">"itis"</span>, <span class="st">"taxonid"</span>)
<span class="co">#&gt; # Source:   table&lt;itis_taxonid&gt; [?? x 6]</span>
<span class="co">#&gt; # Database: MonetDBEmbeddedConnection</span>
<span class="co">#&gt;    id         accepted_id update_date name               rank   name_usage</span>
<span class="co">#&gt;    &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;       &lt;chr&gt;              &lt;chr&gt;  &lt;chr&gt;     </span>
<span class="co">#&gt;  1 ITIS:100   ITIS:50     2015-03-02  Spirillum beijeri… speci… synonym   </span>
<span class="co">#&gt;  2 ITIS:1000… ITIS:724028 2007-06-14  Hypogastrura jond… speci… synonym   </span>
<span class="co">#&gt;  3 ITIS:1000… ITIS:724028 2007-06-14  Achorutes jondavi  speci… synonym   </span>
<span class="co">#&gt;  4 ITIS:1000… ITIS:804239 2016-04-01  Niponius itoi      speci… synonym   </span>
<span class="co">#&gt;  5 ITIS:1000… ITIS:804276 2016-04-01  Chlamydopsis rufo… speci… synonym   </span>
<span class="co">#&gt;  6 ITIS:1000… ITIS:804277 2016-04-01  Chlamydopsis mast… speci… synonym   </span>
<span class="co">#&gt;  7 ITIS:1000… ITIS:804279 2016-04-01  Chlamydopsis darw… speci… synonym   </span>
<span class="co">#&gt;  8 ITIS:1000… ITIS:804309 2016-04-01  Chlamydopsis exca… speci… synonym   </span>
<span class="co">#&gt;  9 ITIS:1000… ITIS:804309 2016-04-01  Chlamydopsis punc… speci… synonym   </span>
<span class="co">#&gt; 10 ITIS:1000… ITIS:724073 2007-06-14  Hypogastrura pseu… speci… synonym   </span>
<span class="co">#&gt; # ... with more rows</span></code></pre></div>
<p>Note that <code>taxald</code> tables report all identifiers using authority prefixes. Certain authorities only provide taxanomic identifiers to species names (rank is always species). Currently this includes <code>gbif</code>, <code>fb</code>, <code>slb</code>. <code>ncbi</code>, <code>col</code> and <code>itis</code> provide taxonomic identifers to scientific names at any rank.</p>
</div>
<div id="hierarchy-table" class="section level2">
<h2 class="hasAnchor">
<a href="#hierarchy-table" class="anchor"></a>Hierarchy table</h2>
<p>Any valid rank is a column, and a taxon <code>id</code> is a unique key.</p>
<p>First column is named <code>id</code>, all subsequent columns are corresponding rank names. Note that this wide format does not support unnamed rank levels, which are common in certain classifications such as NCBI. Additional issues arise in some databases (e.g. also in NCBI) where a rank name is duplicated.</p>
<p>Example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../../reference/taxa_tbl.html">taxa_tbl</a></span>(<span class="st">"col"</span>, <span class="st">"hierarchy"</span>)
<span class="co">#&gt; # Source:   table&lt;col_hierarchy&gt; [?? x 11]</span>
<span class="co">#&gt; # Database: MonetDBEmbeddedConnection</span>
<span class="co">#&gt;    id    kingdom phylum class order superfamily family genus subgenus</span>
<span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   </span>
<span class="co">#&gt;  1 COL:2 Animal… Mollu… Gast… Styl… Rhytidoidea Rhyti… Tasm… &lt;NA&gt;    </span>
<span class="co">#&gt;  2 COL:6 Animal… Mollu… Gast… Styl… Rhytidoidea Rhyti… Tasm… &lt;NA&gt;    </span>
<span class="co">#&gt;  3 COL:8 Animal… Mollu… Gast… Styl… Rhytidoidea Rhyti… Torr… &lt;NA&gt;    </span>
<span class="co">#&gt;  4 COL:… Animal… Mollu… Gast… Styl… Rhytidoidea Rhyti… Vict… &lt;NA&gt;    </span>
<span class="co">#&gt;  5 COL:… Animal… Mollu… Gast… Styl… Rhytidoidea Rhyti… Vict… &lt;NA&gt;    </span>
<span class="co">#&gt;  6 COL:… Animal… Mollu… Gast… Styl… Rhytidoidea Rhyti… Vict… &lt;NA&gt;    </span>
<span class="co">#&gt;  7 COL:… Animal… Mollu… Gast… Styl… Rhytidoidea Rhyti… Vict… &lt;NA&gt;    </span>
<span class="co">#&gt;  8 COL:… Animal… Mollu… Gast… Styl… Acavoidea   Caryo… Anog… &lt;NA&gt;    </span>
<span class="co">#&gt;  9 COL:… Animal… Mollu… Gast… Styl… Acavoidea   Caryo… Braz… &lt;NA&gt;    </span>
<span class="co">#&gt; 10 COL:… Animal… Mollu… Gast… Styl… Acavoidea   Caryo… Cary… &lt;NA&gt;    </span>
<span class="co">#&gt; # ... with more rows, and 2 more variables: species &lt;chr&gt;,</span>
<span class="co">#&gt; #   infraspecies &lt;chr&gt;</span></code></pre></div>
</div>
<div id="synonyms-table" class="section level2">
<h2 class="hasAnchor">
<a href="#synonyms-table" class="anchor"></a>Synonyms table</h2>
<p>A synonyms table can be build for most but not all authorities. Columns in the synonyms table are:</p>
<ul>
<li>
<code>synonym</code>: Synonym or any other type (misspelling, alternate name) that is not the accepted name but can be unambiguously matched to an accepted name.<br>
</li>
<li>
<code>accepted_name</code>: The corresponding accepted name according to the authority</li>
<li>
<code>accepted_id</code>: the id of the <em>accepted name</em>
</li>
<li>
<code>rank</code>: the rank of the accepted name.</li>
</ul>
<p>Optional fields</p>
<ul>
<li>
<code>synonym_id</code>: Some authorities (e.g. ITIS, FB, COL) provide unique identifiers corresponding to the synonym name.<br>
</li>
<li>
<code>name_type</code>: the type of name given in <code>name</code>, e.g. <code>synonym</code>, <code>misspelling</code>, etc.</li>
</ul>
<p>Example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../../reference/taxa_tbl.html">taxa_tbl</a></span>(<span class="st">"gbif"</span>, <span class="st">"synonyms"</span>)
<span class="co">#&gt; # Source:   table&lt;gbif_synonyms&gt; [?? x 5]</span>
<span class="co">#&gt; # Database: MonetDBEmbeddedConnection</span>
<span class="co">#&gt;    id        accepted_name     rank    name              name_type</span>
<span class="co">#&gt;    &lt;chr&gt;     &lt;chr&gt;             &lt;chr&gt;   &lt;chr&gt;             &lt;chr&gt;    </span>
<span class="co">#&gt;  1 GBIF:0    incertae sedis    kingdom incertae sedis    doubtful </span>
<span class="co">#&gt;  2 GBIF:104  Prasinophyta      phylum  Prasinophyta      synonym  </span>
<span class="co">#&gt;  3 GBIF:191  Bryopsidophyceae  class   Bryopsidophyceae  synonym  </span>
<span class="co">#&gt;  4 GBIF:287  Fragilariophyceae class   Fragilariophyceae synonym  </span>
<span class="co">#&gt;  5 GBIF:835  Eutreptiales      order   Eutreptiales      synonym  </span>
<span class="co">#&gt;  6 GBIF:1345 Chlorococcales    order   Chlorococcales    synonym  </span>
<span class="co">#&gt;  7 GBIF:1902 Krohnitelldae     family  Krohnitelldae     synonym  </span>
<span class="co">#&gt;  8 GBIF:1909 Chlorangiaceae    family  Chlorangiaceae    synonym  </span>
<span class="co">#&gt;  9 GBIF:1964 Haploposthiidae   family  Haploposthiidae   synonym  </span>
<span class="co">#&gt; 10 GBIF:1976 Questidae         family  Questidae         synonym  </span>
<span class="co">#&gt; # ... with more rows</span></code></pre></div>
</div>
<div id="common-names" class="section level2">
<h2 class="hasAnchor">
<a href="#common-names" class="anchor"></a>Common names</h2>
<p>Common names are avialable from several authorities, but tidy tables for <code>taxald</code> have not yet been implemented. Common names tables are expected to follow the following schema:</p>
<ul>
<li>
<code>id</code> The taxonomic identifier for the species (or possibly other rank)</li>
<li>
<code>name</code> The common name / vernacular name</li>
<li>
<code>language</code> The language in which the common name is given, if known. (all lowercase)</li>
<li>
<code>language_code</code> the two-letter language code.</li>
</ul>
</div>
<div id="long-format" class="section level2">
<h2 class="hasAnchor">
<a href="#long-format" class="anchor"></a>Long format</h2>
<p>Single-table representation of core taxonomic and hierarchical data. Format includes followings required columns:</p>
<table class="table">
<thead><tr class="header">
<th>id</th>
<th>name</th>
<th>rank</th>
<th>path</th>
<th>path_rank</th>
<th>path_id</th>
</tr></thead>
<tbody></tbody>
</table>
<p>And the following optional columns:</p>
<table class="table">
<thead><tr class="header">
<th>rank_id</th>
<th>path_rank_id</th>
<th>name_type</th>
<th>date</th>
<th>common_name</th>
</tr></thead>
<tbody></tbody>
</table>
<p>(Most databases do not define <code>rank_id</code>, e.g. ids corresponding to the ranks themselves)</p>
<p>These tables are considerably larger and longer than other formats, which can make them slow to query. Note that for each taxonomic name, <code>id</code> and the corresponding <code>name</code>, and <code>rank</code> of the <code>id</code> are repeated across the full path hierarchy. This format is not installed and not used by functions of <code>taxald</code> at this time.</p>
<p>A fundamental advantage of this format is that it can be defined identically for every table, meaning that all authorities could be combined into a single table using the long format. both the <code>taxonid</code> and <code>hierarchy</code> formats can be derived directly from this format, and this format can represent information such as unnamed or duplicate ranks that cannot be represented in the <code>hierarchy</code> format.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../../reference/taxa_tbl.html">taxa_tbl</a></span>(<span class="st">"itis"</span>, <span class="st">"long"</span>, <span class="ot">NULL</span>)</code></pre></div>
</div>
<div id="conventions" class="section level2">
<h2 class="hasAnchor">
<a href="#conventions" class="anchor"></a>Conventions</h2>
<ul>
<li>
<code>species</code> is always given as the scientific name associated with the species; e.g. <code>Homo sapiens</code> not <code>sapiens</code>. (ITIS convention)</li>
<li>Identifiers use the integer identifier defined by the authority, prefixed by the authority abbreviation in all capital letters: <code>ITIS:</code>, <code>GBIF:</code>, etc.</li>
<li>Rank names are always lower case without hyphens or spaces. Rank names should be mapped to a table of standard accepted rank names (i.e. those recognized by ITIS, NCBI, Wikidata), and rank names should have</li>
<li>Encoding is UTF-8</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#taxonid-schema">taxonid schema</a></li>
      <li><a href="#hierarchy-table">Hierarchy table</a></li>
      <li><a href="#synonyms-table">Synonyms table</a></li>
      <li><a href="#common-names">Common names</a></li>
      <li><a href="#long-format">Long format</a></li>
      <li><a href="#conventions">Conventions</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Carl Boettiger, Kari Norman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
