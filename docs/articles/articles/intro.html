<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tutorial for taxadb â€¢ taxadb</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Tutorial for taxadb">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">taxadb</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/articles/backends.html">Backends for taxadb</a>
    </li>
    <li>
      <a href="../../articles/articles/data-sources.html">Name Providers and schema used in taxadb</a>
    </li>
    <li>
      <a href="../../articles/articles/intro.html">Tutorial for taxadb</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/cboettig/taxadb">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Tutorial for taxadb</h1>
                        <h4 class="author">Carl Boettiger, Kari Norman</h4>
            
            <h4 class="date">2019-10-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/cboettig/taxadb/blob/master/vignettes/articles/intro.Rmd"><code>vignettes/articles/intro.Rmd</code></a></small>
      <div class="hidden name"><code>intro.Rmd</code></div>

    </div>

    
    
<p>Here we illustrate the use of <code>taxadb</code> to resolve names in the Breeding Bird Survey species list more completely. To get started, we load the necessary libraries and create the local copy of the <code>taxadb</code> database for all naming providers, if we have not already done so:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(readr)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(taxadb)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="../../reference/td_create.html">td_create</a></span>(<span class="st">"all"</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt; Warning: 2 parsing failures.</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt;   row            col                     expected    actual         file</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt; 96637 scientificName closing quote at end of file           literal data</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt; 96637 NA             13 columns                   2 columns literal data</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; Warning: 700 parsing failures.</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt; row col   expected     actual         file</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt;   1  -- 13 columns 11 columns literal data</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt;   2  -- 13 columns 11 columns literal data</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt;   3  -- 13 columns 11 columns literal data</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt;   4  -- 13 columns 11 columns literal data</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt;   5  -- 13 columns 11 columns literal data</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#&gt; ... ... .......... .......... ............</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt; See problems(...) for more details.</span></a></code></pre></div>
<p>Note that by default, <code><a href="../../reference/td_create.html">td_create()</a></code> will not attempt to overwrite any providers which we have already installed. This means we can freely include <code><a href="../../reference/td_create.html">td_create()</a></code> at the beginning of scripts and analysis for reproducibility without concern that it will keep re-downloading and slowing things down. With this in place, we are ready to load in the species list from the Breeding Bird Survey <span class="citation">[@bbs]</span>, taken from <a href="ftp://ftpext.usgs.gov/pub/er/md/laurel/BBS/DataFiles/SpeciesList.txt" class="uri">ftp://ftpext.usgs.gov/pub/er/md/laurel/BBS/DataFiles/SpeciesList.txt</a>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">bbs &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/readr/man/read_delim.html">read_tsv</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata/bbs.tsv"</span>, <span class="dt">package=</span><span class="st">"taxadb"</span>))</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">bbs</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt; # A tibble: 750 x 9</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt;      Seq AOU   English_Common_â€¦ French_Common_Nâ€¦ Spanish_Common_â€¦ order</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt;    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#&gt;  1     6 01770 Black-bellied Wâ€¦ "Dendrocygne \xâ€¦ Dendrocygna autâ€¦ Anseâ€¦</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt;  2     7 01780 Fulvous Whistliâ€¦ Dendrocygne fauâ€¦ Dendrocygna bicâ€¦ Anseâ€¦</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt;  3     8 01760 Emperor Goose    Oie empereur     Anser canagicus  Anseâ€¦</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt;  4     9 01690 Snow Goose       Oie des neiges   Anser caerulescâ€¦ Anseâ€¦</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt;  5    10 01691 (Blue Goose) Snâ€¦ Oie des neiges â€¦ Chen caerulesceâ€¦ Anseâ€¦</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#&gt;  6    11 01700 Ross's Goose     Oie de Ross      Anser rossii     Anseâ€¦</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt;  7    13 01710 Greater White-fâ€¦ Oie rieuse       Anser albifrons  Anseâ€¦</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt;  8    18 01730 Brant            Bernache cravant Branta bernicla  Anseâ€¦</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt;  9    19 01740 (Black Brant) Bâ€¦ Bernache cravanâ€¦ Branta berniclaâ€¦ Anseâ€¦</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">#&gt; 10    21 01725 Cackling Goose   Bernache de Hutâ€¦ Branta hutchinsâ€¦ Anseâ€¦</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co">#&gt; # â€¦ with 740 more rows, and 3 more variables: family &lt;chr&gt;, genus &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co">#&gt; #   species &lt;chr&gt;</span></a></code></pre></div>
<p>We see that the resulting table has 750 unique rows of names. If we wish to combine data from the BBS with other data on these same species, such as trait data, we need to be able to resolve the species names to unique identifiers. We could then likewise resolve the species names used in the trait data or any other data we wish to combine against the same naming provider, giving us a consistent set of identifiers. Mixing identifiers from different naming providers is not ideal, as it not only gives us unmatched identifiers for the same species (e.g.Â ITIS:180092 and NCBI:9606 are both identifiers for <em>Homo sapiens</em>), but can also raise deeper challenges when different providers work from different taxonomic concepts.</p>
<p>Despite the BBS being a widely used and long established data set, a quick look (~30s to check against nearly 15 million names) with taxadb confirms that none of the providers includes all the species names used in the BBS.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span>({</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">bbs_ids &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">bbs <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span>(species) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span>(</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">         <span class="dt">gbif =</span> <span class="kw"><a href="../../reference/get_ids.html">get_ids</a></span>(species, <span class="st">"gbif"</span>),</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">          <span class="dt">col =</span> <span class="kw"><a href="../../reference/get_ids.html">get_ids</a></span>(species, <span class="st">"col"</span> ),</a>
<a class="sourceLine" id="cb4-8" data-line-number="8">         <span class="dt">itis =</span> <span class="kw"><a href="../../reference/get_ids.html">get_ids</a></span>(species, <span class="st">"itis"</span>),</a>
<a class="sourceLine" id="cb4-9" data-line-number="9">         <span class="dt">ncbi =</span> <span class="kw"><a href="../../reference/get_ids.html">get_ids</a></span>(species, <span class="st">"ncbi"</span>),</a>
<a class="sourceLine" id="cb4-10" data-line-number="10">           <span class="dt">wd =</span> <span class="kw"><a href="../../reference/get_ids.html">get_ids</a></span>(species, <span class="st">"wd"</span>  ),</a>
<a class="sourceLine" id="cb4-11" data-line-number="11">         <span class="dt">iucn =</span> <span class="kw"><a href="../../reference/get_ids.html">get_ids</a></span>(species, <span class="st">"iucn"</span>),</a>
<a class="sourceLine" id="cb4-12" data-line-number="12">          <span class="dt">ott =</span> <span class="kw"><a href="../../reference/get_ids.html">get_ids</a></span>(species, <span class="st">"ott"</span> ) </a>
<a class="sourceLine" id="cb4-13" data-line-number="13">  )</a>
<a class="sourceLine" id="cb4-14" data-line-number="14">})</a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt;    user  system elapsed </span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt;  18.805   0.778   2.877</span></a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">bbs_ids <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span>(<span class="op">-</span>species) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="st">  </span>purrr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/purrr/man/map.html">map_dbl</a></span>(<span class="cf">function</span>(x) <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(x)))</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt; gbif  col itis ncbi   wd iucn  ott </span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt;  306  587  656  184  630  643  665</span></a></code></pre></div>
<p>The <code><a href="../../reference/get_ids.html">get_ids()</a></code> function looks only for exact matches. Certain names may not uniquely resolve to a single ID, such as a name which is a recognized synonym for two separate taxonomic groups (such as may happen if a species is split.) OTT identifies the most, at 665 out of 750 names.</p>
<p>We can get more matches by cleaning the names first. The <code><a href="../../reference/clean_names.html">clean_names()</a></code> function provides several simple string manipulations to tidy names to improve the probability of a match: missing species (specific epithets) such as <code>Accipiter sp.</code> drop the <code>sp.</code>, allowing matches against Genus names, and intraspecific epithets such as <code>Colaptes auratus cafer</code> are dropped to binomial names, <code>Colaptes auratus</code>. These transformations may not be appropriate for certain use cases, and should be used with care.</p>
<p>Observe that truncating names would result in a handful of subspecies being resolved only to the species level identifiers:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">bbs_cleaned_ids &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="st">  </span>bbs_ids <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span>(species, ott) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span>(<span class="dt">ids_post_clean =</span> </a>
<a class="sourceLine" id="cb6-5" data-line-number="5">           <span class="kw"><a href="../../reference/get_ids.html">get_ids</a></span>(<span class="kw"><a href="../../reference/clean_names.html">clean_names</a></span>(species, <span class="dt">binomial_only =</span> <span class="ot">TRUE</span>), </a>
<a class="sourceLine" id="cb6-6" data-line-number="6">                   <span class="st">"ott"</span>, <span class="st">"prefix"</span>))</a>
<a class="sourceLine" id="cb6-7" data-line-number="7">bbs_cleaned_ids <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span>(ott <span class="op">!=</span><span class="st"> </span>ids_post_clean)</a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt; # A tibble: 6 x 3</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt;   species                            ott         ids_post_clean</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt;   &lt;chr&gt;                              &lt;chr&gt;       &lt;chr&gt;         </span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt; 1 Branta bernicla nigricans          OTT:799107  OTT:135287    </span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt; 2 Anas platyrhynchos diazi           OTT:82410   OTT:765167    </span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt; 3 Buteo jamaicensis harlani          OTT:1070094 OTT:509839    </span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt; 4 Vermivora chrysoptera x cyanoptera OTT:6153649 OTT:85249     </span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt; 5 Setophaga coronata coronata        OTT:349904  OTT:451168    </span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">#&gt; 6 Passerina amoena x cyanea          OTT:4947623 OTT:119888</span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17">x &lt;-<span class="st"> </span>bbs_cleaned_ids <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span>(ott <span class="op">!=</span><span class="st"> </span>ids_post_clean)  </a>
<a class="sourceLine" id="cb6-18" data-line-number="18"></a>
<a class="sourceLine" id="cb6-19" data-line-number="19">x</a>
<a class="sourceLine" id="cb6-20" data-line-number="20"><span class="co">#&gt; # A tibble: 6 x 3</span></a>
<a class="sourceLine" id="cb6-21" data-line-number="21"><span class="co">#&gt;   species                            ott         ids_post_clean</span></a>
<a class="sourceLine" id="cb6-22" data-line-number="22"><span class="co">#&gt;   &lt;chr&gt;                              &lt;chr&gt;       &lt;chr&gt;         </span></a>
<a class="sourceLine" id="cb6-23" data-line-number="23"><span class="co">#&gt; 1 Branta bernicla nigricans          OTT:799107  OTT:135287    </span></a>
<a class="sourceLine" id="cb6-24" data-line-number="24"><span class="co">#&gt; 2 Anas platyrhynchos diazi           OTT:82410   OTT:765167    </span></a>
<a class="sourceLine" id="cb6-25" data-line-number="25"><span class="co">#&gt; 3 Buteo jamaicensis harlani          OTT:1070094 OTT:509839    </span></a>
<a class="sourceLine" id="cb6-26" data-line-number="26"><span class="co">#&gt; 4 Vermivora chrysoptera x cyanoptera OTT:6153649 OTT:85249     </span></a>
<a class="sourceLine" id="cb6-27" data-line-number="27"><span class="co">#&gt; 5 Setophaga coronata coronata        OTT:349904  OTT:451168    </span></a>
<a class="sourceLine" id="cb6-28" data-line-number="28"><span class="co">#&gt; 6 Passerina amoena x cyanea          OTT:4947623 OTT:119888</span></a>
<a class="sourceLine" id="cb6-29" data-line-number="29"><span class="kw"><a href="../../reference/by_id.html">by_id</a></span>(x<span class="op">$</span>ids_post_clean, <span class="dt">provider =</span> <span class="st">"ott"</span>)</a>
<a class="sourceLine" id="cb6-30" data-line-number="30"><span class="co">#&gt; # A tibble: 6 x 15</span></a>
<a class="sourceLine" id="cb6-31" data-line-number="31"><span class="co">#&gt;   input  sort taxonID scientificName taxonRank acceptedNameUsaâ€¦</span></a>
<a class="sourceLine" id="cb6-32" data-line-number="32"><span class="co">#&gt;   &lt;chr&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;          &lt;chr&gt;     &lt;chr&gt;           </span></a>
<a class="sourceLine" id="cb6-33" data-line-number="33"><span class="co">#&gt; 1 OTT:â€¦     1 OTT:13â€¦ Branta bernicâ€¦ species   OTT:135287      </span></a>
<a class="sourceLine" id="cb6-34" data-line-number="34"><span class="co">#&gt; 2 OTT:â€¦     2 OTT:76â€¦ Anas platyrhyâ€¦ species   OTT:765167      </span></a>
<a class="sourceLine" id="cb6-35" data-line-number="35"><span class="co">#&gt; 3 OTT:â€¦     3 OTT:50â€¦ Buteo jamaiceâ€¦ species   OTT:509839      </span></a>
<a class="sourceLine" id="cb6-36" data-line-number="36"><span class="co">#&gt; 4 OTT:â€¦     4 OTT:85â€¦ Vermivora chrâ€¦ species   OTT:85249       </span></a>
<a class="sourceLine" id="cb6-37" data-line-number="37"><span class="co">#&gt; 5 OTT:â€¦     5 OTT:45â€¦ Setophaga corâ€¦ species   OTT:451168      </span></a>
<a class="sourceLine" id="cb6-38" data-line-number="38"><span class="co">#&gt; 6 OTT:â€¦     6 OTT:11â€¦ Passerina amoâ€¦ species   OTT:119888      </span></a>
<a class="sourceLine" id="cb6-39" data-line-number="39"><span class="co">#&gt; # â€¦ with 9 more variables: taxonomicStatus &lt;chr&gt;, kingdom &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb6-40" data-line-number="40"><span class="co">#&gt; #   phylum &lt;chr&gt;, class &lt;chr&gt;, order &lt;chr&gt;, family &lt;chr&gt;, genus &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb6-41" data-line-number="41"><span class="co">#&gt; #   specificEpithet &lt;chr&gt;, infraspecificEpithet &lt;chr&gt;</span></a></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">bbs_cleaned_ids <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(ott) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(ids_post_clean))</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">#&gt; # A tibble: 75 x 3</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt;    species                                     ott   ids_post_clean</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt;    &lt;chr&gt;                                       &lt;chr&gt; &lt;chr&gt;         </span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt;  1 Chen caerulescens (blue form)               &lt;NA&gt;  OTT:190878    </span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt;  2 Anas platyrhynchos x rubripes or fulvigula  &lt;NA&gt;  OTT:765167    </span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt;  3 Aythya marila / affinis                     &lt;NA&gt;  OTT:1044561   </span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt;  4 Melanitta perspicillata / fusca / americana &lt;NA&gt;  OTT:972536    </span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt;  5 Bucephala clangula / islandica              &lt;NA&gt;  OTT:166683    </span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt;  6 Dendragapus obscurus / fuliginosus          &lt;NA&gt;  OTT:1003843   </span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt;  7 Aechmophorus occidentalis / clarkii         &lt;NA&gt;  OTT:758343    </span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt;  8 Coccyzus americanus / erythropthalmus       &lt;NA&gt;  OTT:891425    </span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#&gt;  9 Chordeiles acutipennis / minor              &lt;NA&gt;  OTT:484902    </span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">#&gt; 10 Chordeiles minor / gundlachii               &lt;NA&gt;  OTT:870594    </span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#&gt; # â€¦ with 65 more rows</span></a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">pick &lt;-<span class="st"> </span><span class="cf">function</span>(A, B){ A[<span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(A)] &lt;-<span class="st"> </span>B[<span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(A)]; A }</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"></a>
<a class="sourceLine" id="cb8-3" data-line-number="3">ott_ids &lt;-<span class="st"> </span>bbs_cleaned_ids <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span>(<span class="dt">ids =</span> <span class="kw">pick</span>(ott, ids_post_clean))</a></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">unmatched &lt;-<span class="st"> </span>ott_ids <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(ids)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span>(species, ids) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span>(<span class="dt">species =</span> <span class="kw"><a href="../../reference/clean_names.html">clean_names</a></span>(species))</a>
<a class="sourceLine" id="cb9-5" data-line-number="5"></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"></a>
<a class="sourceLine" id="cb9-7" data-line-number="7">unmatched</a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#&gt; # A tibble: 10 x 2</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">#&gt;    species               ids  </span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">#&gt;    &lt;chr&gt;                 &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">#&gt;  1 spatula cyanoptera    &lt;NA&gt; </span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="co">#&gt;  2 antrostomus vociferus &lt;NA&gt; </span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="co">#&gt;  3 antrostomus arizonae  &lt;NA&gt; </span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="co">#&gt;  4 trochilid             &lt;NA&gt; </span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co">#&gt;  5 antigone canadensis   &lt;NA&gt; </span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="co">#&gt;  6 gull                  &lt;NA&gt; </span></a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="co">#&gt;  7 tern                  &lt;NA&gt; </span></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="co">#&gt;  8 ardeid                &lt;NA&gt; </span></a>
<a class="sourceLine" id="cb9-19" data-line-number="19"><span class="co">#&gt;  9 woodpecker            &lt;NA&gt; </span></a>
<a class="sourceLine" id="cb9-20" data-line-number="20"><span class="co">#&gt; 10 icterus townsendi     &lt;NA&gt;</span></a></code></pre></div>
<p>Of the remaining 10 names, 3 are clearly common names (<code>gull</code>, <code>tern</code>, <code>woodpecker</code>), two (<code>trochilid</code> and <code>ardeid</code>) are references to family names, <em>Trochilidae</em> and <em>Ardeidae</em>, and the remaining five are unresolved.</p>
<p>We can confirm that the two family names can be resolved:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Trochilidae"</span>,  <span class="st">"Ardeidae"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../../reference/by_name.html">by_name</a></span>(<span class="st">"ott"</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#&gt; # A tibble: 2 x 15</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&gt;    sort taxonID scientificName taxonRank acceptedNameUsaâ€¦ taxonomicStatus</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt;   &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;          &lt;chr&gt;     &lt;chr&gt;            &lt;chr&gt;          </span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#&gt; 1     1 OTT:81â€¦ Trochilidae    family    OTT:810751       accepted       </span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#&gt; 2     2 OTT:60â€¦ Ardeidae       family    OTT:609781       accepted       </span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#&gt; # â€¦ with 9 more variables: kingdom &lt;chr&gt;, phylum &lt;chr&gt;, class &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt; #   order &lt;chr&gt;, family &lt;chr&gt;, genus &lt;chr&gt;, specificEpithet &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">#&gt; #   infraspecificEpithet &lt;chr&gt;, input &lt;chr&gt;</span></a></code></pre></div>
<p>We can also use the <code>vernacularName</code> field available in some naming providers to resolve common names:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="../../reference/by_rank.html">by_rank</a></span>(<span class="st">"Aves"</span>, <span class="st">"class"</span>, <span class="st">"itis"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"Woodpecker"</span>, vernacularName)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span>(vernacularName, scientificName, acceptedNameUsageID)</a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">#&gt; # A tibble: 181 x 3</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">#&gt;    vernacularName        scientificName                   acceptedNameUsagâ€¦</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#&gt;    &lt;chr&gt;                 &lt;chr&gt;                            &lt;chr&gt;            </span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&gt;  1 Red-bellied Woodpeckâ€¦ Centurus carolinus               ITIS:178195      </span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">#&gt;  2 Red-bellied Woodpeckâ€¦ Centurus carolinus zebra         ITIS:178195      </span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="co">#&gt;  3 Red-bellied Woodpeckâ€¦ Centurus carolinus carolinus     ITIS:178195      </span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="co">#&gt;  4 Red-bellied Woodpeckâ€¦ Centurus carolinus perplexus     ITIS:178195      </span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="co">#&gt;  5 Red-bellied Woodpeckâ€¦ Centurus carolinus harpaceus     ITIS:178195      </span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="co">#&gt;  6 Golden-fronted Woodpâ€¦ Centurus aurifrons               ITIS:178194      </span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="co">#&gt;  7 Gila Woodpecker       Centurus uropygialis             ITIS:178198      </span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="co">#&gt;  8 Red-headed Woodpecker Melanerpes erythrocephalus caurâ€¦ ITIS:178186      </span></a>
<a class="sourceLine" id="cb11-15" data-line-number="15"><span class="co">#&gt;  9 Red-headed Woodpecker Melanerpes erythrocephalus erytâ€¦ ITIS:178186      </span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16"><span class="co">#&gt; 10 Lewis's Woodpecker    Asyndesmus lewis                 ITIS:178196      </span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17"><span class="co">#&gt; # â€¦ with 171 more rows</span></a></code></pre></div>
<p>Let us attempt to resolve the remaining five names.</p>
<p>Consulting IUCN Redlist names, we can resolve acceptedNameUsageIDs for four of these five:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">unmatched <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">" "</span>, species)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span>(<span class="dt">iucn =</span> <span class="kw"><a href="../../reference/get_ids.html">get_ids</a></span>(species, <span class="st">"iucn"</span>, <span class="st">"prefix"</span>))</a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co">#&gt; # A tibble: 5 x 3</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">#&gt;   species               ids   iucn         </span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co">#&gt;   &lt;chr&gt;                 &lt;chr&gt; &lt;chr&gt;        </span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">#&gt; 1 spatula cyanoptera    &lt;NA&gt;  IUCN:22680233</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co">#&gt; 2 antrostomus vociferus &lt;NA&gt;  IUCN:22736393</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="co">#&gt; 3 antrostomus arizonae  &lt;NA&gt;  IUCN:22736398</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co">#&gt; 4 antigone canadensis   &lt;NA&gt;  IUCN:22692078</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="co">#&gt; 5 icterus townsendi     &lt;NA&gt;  &lt;NA&gt;</span></a></code></pre></div>
<p>By consulting the synonyms table, we can quickly see what other names these species might be known by:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">syn &lt;-<span class="st"> </span>unmatched<span class="op">$</span>species <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../../reference/synonyms.html">synonyms</a></span>(<span class="st">"iucn"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/distinct.html">distinct</a></span>()</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">syn</a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co">#&gt; # A tibble: 11 x 5</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co">#&gt;    acceptedNameUsage  synonym       taxonRank acceptedNameUsagâ€¦ input      </span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co">#&gt;    &lt;chr&gt;              &lt;chr&gt;         &lt;chr&gt;     &lt;chr&gt;             &lt;chr&gt;      </span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co">#&gt;  1 Spatula cyanoptera Anas cyanoptâ€¦ species   IUCN:22680233     spatula cyâ€¦</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="co">#&gt;  2 Antrostomus vocifâ€¦ Caprimulgus â€¦ species   IUCN:22736393     antrostomuâ€¦</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="co">#&gt;  3 Antrostomus arizoâ€¦ Caprimulgus â€¦ species   IUCN:22736398     antrostomuâ€¦</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="co">#&gt;  4 Antrostomus arizoâ€¦ Caprimulgus â€¦ species   IUCN:22736398     antrostomuâ€¦</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="co">#&gt;  5 &lt;NA&gt;               &lt;NA&gt;          &lt;NA&gt;      &lt;NA&gt;              trochilid  </span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="co">#&gt;  6 Antigone canadensâ€¦ Grus canadenâ€¦ species   IUCN:22692078     antigone câ€¦</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="co">#&gt;  7 &lt;NA&gt;               &lt;NA&gt;          &lt;NA&gt;      &lt;NA&gt;              gull       </span></a>
<a class="sourceLine" id="cb13-14" data-line-number="14"><span class="co">#&gt;  8 &lt;NA&gt;               &lt;NA&gt;          &lt;NA&gt;      &lt;NA&gt;              tern       </span></a>
<a class="sourceLine" id="cb13-15" data-line-number="15"><span class="co">#&gt;  9 &lt;NA&gt;               &lt;NA&gt;          &lt;NA&gt;      &lt;NA&gt;              ardeid     </span></a>
<a class="sourceLine" id="cb13-16" data-line-number="16"><span class="co">#&gt; 10 &lt;NA&gt;               &lt;NA&gt;          &lt;NA&gt;      &lt;NA&gt;              woodpecker </span></a>
<a class="sourceLine" id="cb13-17" data-line-number="17"><span class="co">#&gt; 11 &lt;NA&gt;               &lt;NA&gt;          &lt;NA&gt;      &lt;NA&gt;              icterus toâ€¦</span></a></code></pre></div>
<p>Note that three of the four synonyms given by IUCN are considered accepted names in OTT:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">syn <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/select.html">rename</a></span>(<span class="dt">IUCN_name =</span> acceptedNameUsage,</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">         <span class="dt">OTT_name =</span> synonym) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span>(<span class="dt">ott_id =</span>  <span class="kw"><a href="../../reference/get_ids.html">get_ids</a></span>(OTT_name, <span class="st">"ott"</span>),</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">         <span class="dt">iucn_id =</span> <span class="kw"><a href="../../reference/get_ids.html">get_ids</a></span>(IUCN_name, <span class="st">"iucn"</span>))</a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">#&gt; # A tibble: 11 x 7</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="co">#&gt;    IUCN_name   OTT_name   taxonRank acceptedNameUsagâ€¦ input  ott_id iucn_id</span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co">#&gt;    &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;             &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  </span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="co">#&gt;  1 Spatula cyâ€¦ Anas cyanâ€¦ species   IUCN:22680233     spatuâ€¦ OTT:8â€¦ IUCN:2â€¦</span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="co">#&gt;  2 Antrostomuâ€¦ Caprimulgâ€¦ species   IUCN:22736393     antroâ€¦ OTT:1â€¦ IUCN:2â€¦</span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="co">#&gt;  3 Antrostomuâ€¦ Caprimulgâ€¦ species   IUCN:22736398     antroâ€¦ OTT:1â€¦ IUCN:2â€¦</span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="co">#&gt;  4 Antrostomuâ€¦ Caprimulgâ€¦ species   IUCN:22736398     antroâ€¦ &lt;NA&gt;   IUCN:2â€¦</span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="co">#&gt;  5 &lt;NA&gt;        &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;              trochâ€¦ &lt;NA&gt;   &lt;NA&gt;   </span></a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="co">#&gt;  6 Antigone câ€¦ Grus canaâ€¦ species   IUCN:22692078     antigâ€¦ OTT:2â€¦ IUCN:2â€¦</span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15"><span class="co">#&gt;  7 &lt;NA&gt;        &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;              gull   &lt;NA&gt;   &lt;NA&gt;   </span></a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="co">#&gt;  8 &lt;NA&gt;        &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;              tern   &lt;NA&gt;   &lt;NA&gt;   </span></a>
<a class="sourceLine" id="cb14-17" data-line-number="17"><span class="co">#&gt;  9 &lt;NA&gt;        &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;              ardeid &lt;NA&gt;   &lt;NA&gt;   </span></a>
<a class="sourceLine" id="cb14-18" data-line-number="18"><span class="co">#&gt; 10 &lt;NA&gt;        &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;              woodpâ€¦ &lt;NA&gt;   &lt;NA&gt;   </span></a>
<a class="sourceLine" id="cb14-19" data-line-number="19"><span class="co">#&gt; 11 &lt;NA&gt;        &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;              icterâ€¦ &lt;NA&gt;   &lt;NA&gt;</span></a></code></pre></div>
<p>We cannot simply assume that we can crosswalk synonyms between different providers, as providers may be operating on different taxonomic concepts. In this example, IUCN recognizes four distinct taxa while OTT recognizes only thee.</p>
<div id="differences-in-taxonomic-concepts" class="section level2">
<h2 class="hasAnchor">
<a href="#differences-in-taxonomic-concepts" class="anchor"></a>Differences in taxonomic concepts:</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">cranes &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Megalornis canadensis"</span>, <span class="st">"Antigone canadensis"</span>, <span class="st">"Grus canadensis"</span>)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="kw"><a href="../../reference/synonyms.html">synonyms</a></span>(cranes, <span class="st">"gbif"</span>)</a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="co">#&gt; # A tibble: 6 x 5</span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="co">#&gt;   acceptedNameUsage synonym        taxonRank acceptedNameUsagâ€¦ input       </span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5"><span class="co">#&gt;   &lt;chr&gt;             &lt;chr&gt;          &lt;chr&gt;     &lt;chr&gt;             &lt;chr&gt;       </span></a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="co">#&gt; 1 Grus canadensis   Megalornis caâ€¦ species   GBIF:2474953      Megalornis â€¦</span></a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="co">#&gt; 2 Grus canadensis   Antigone canaâ€¦ species   GBIF:2474953      Megalornis â€¦</span></a>
<a class="sourceLine" id="cb15-8" data-line-number="8"><span class="co">#&gt; 3 Grus canadensis   Megalornis caâ€¦ species   GBIF:2474953      Antigone caâ€¦</span></a>
<a class="sourceLine" id="cb15-9" data-line-number="9"><span class="co">#&gt; 4 Grus canadensis   Antigone canaâ€¦ species   GBIF:2474953      Antigone caâ€¦</span></a>
<a class="sourceLine" id="cb15-10" data-line-number="10"><span class="co">#&gt; 5 Grus canadensis   Megalornis caâ€¦ species   GBIF:2474953      Grus canadeâ€¦</span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11"><span class="co">#&gt; 6 Grus canadensis   Antigone canaâ€¦ species   GBIF:2474953      Grus canadeâ€¦</span></a></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="../../reference/synonyms.html">synonyms</a></span>(cranes, <span class="st">"iucn"</span>)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="co">#&gt; # A tibble: 3 x 5</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="co">#&gt;   acceptedNameUsage  synonym      taxonRank acceptedNameUsagâ€¦ input        </span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="co">#&gt;   &lt;chr&gt;              &lt;chr&gt;        &lt;chr&gt;     &lt;chr&gt;             &lt;chr&gt;        </span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="co">#&gt; 1 &lt;NA&gt;               &lt;NA&gt;         &lt;NA&gt;      &lt;NA&gt;              Megalornis câ€¦</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="co">#&gt; 2 Antigone canadensâ€¦ Grus canadeâ€¦ species   IUCN:22692078     Antigone canâ€¦</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="co">#&gt; 3 Antigone canadensâ€¦ Grus canadeâ€¦ species   IUCN:22692078     Grus canadenâ€¦</span></a></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw"><a href="../../reference/synonyms.html">synonyms</a></span>(cranes, <span class="st">"ott"</span>)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="co">#&gt; # A tibble: 3 x 5</span></a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="co">#&gt;   acceptedNameUsage synonym     taxonRank acceptedNameUsagâ€¦ input          </span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="co">#&gt;   &lt;chr&gt;             &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;             &lt;chr&gt;          </span></a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="co">#&gt; 1 &lt;NA&gt;              &lt;NA&gt;        &lt;NA&gt;      &lt;NA&gt;              Megalornis canâ€¦</span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="co">#&gt; 2 &lt;NA&gt;              &lt;NA&gt;        &lt;NA&gt;      &lt;NA&gt;              Antigone canadâ€¦</span></a>
<a class="sourceLine" id="cb17-7" data-line-number="7"><span class="co">#&gt; 3 Grus canadensis   Grus proavâ€¦ species   OTT:257929        Grus canadensis</span></a></code></pre></div>
<p>(GBIF lists <em>Antigone canadensis</em> as a synonym for <em>Grus canadensis</em>; this appears backwards as the Sandhill Crane was moved out of <em>Grus</em> after molecular analyses showed it made that taxon polyphyletic; <a href="https://en.wikipedia.org/wiki/Sandhill_crane" class="uri">https://en.wikipedia.org/wiki/Sandhill_crane</a>).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">totals &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/reexports.html">tibble</a></span>(</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="st">"itis"</span> =<span class="st"> </span><span class="kw"><a href="../../reference/taxa_tbl.html">taxa_tbl</a></span>(<span class="st">"itis"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/tally.html">count</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/pull.html">pull</a></span>(n),</a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="st">"ncbi"</span> =<span class="st"> </span><span class="kw"><a href="../../reference/taxa_tbl.html">taxa_tbl</a></span>(<span class="st">"ncbi"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/tally.html">count</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/pull.html">pull</a></span>(n),</a>
<a class="sourceLine" id="cb18-4" data-line-number="4"><span class="st">"col"</span> =<span class="st"> </span><span class="kw"><a href="../../reference/taxa_tbl.html">taxa_tbl</a></span>(<span class="st">"col"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/tally.html">count</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/pull.html">pull</a></span>(n),</a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="st">"gbif"</span> =<span class="st"> </span><span class="kw"><a href="../../reference/taxa_tbl.html">taxa_tbl</a></span>(<span class="st">"gbif"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/tally.html">count</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/pull.html">pull</a></span>(n),</a>
<a class="sourceLine" id="cb18-6" data-line-number="6"><span class="st">"ott"</span> =<span class="st"> </span><span class="kw"><a href="../../reference/taxa_tbl.html">taxa_tbl</a></span>(<span class="st">"ott"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/tally.html">count</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/pull.html">pull</a></span>(n),</a>
<a class="sourceLine" id="cb18-7" data-line-number="7"><span class="st">"wd"</span> =<span class="st"> </span><span class="kw"><a href="../../reference/taxa_tbl.html">taxa_tbl</a></span>(<span class="st">"wd"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/tally.html">count</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/pull.html">pull</a></span>(n),</a>
<a class="sourceLine" id="cb18-8" data-line-number="8"><span class="st">"iucn"</span> =<span class="st"> </span><span class="kw"><a href="../../reference/taxa_tbl.html">taxa_tbl</a></span>(<span class="st">"iucn"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/tally.html">count</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/pull.html">pull</a></span>(n),</a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="st">"fb"</span> =<span class="st"> </span><span class="kw"><a href="../../reference/taxa_tbl.html">taxa_tbl</a></span>(<span class="st">"fb"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/tally.html">count</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/pull.html">pull</a></span>(n),</a>
<a class="sourceLine" id="cb18-10" data-line-number="10"><span class="st">"slb"</span> =<span class="st"> </span><span class="kw"><a href="../../reference/taxa_tbl.html">taxa_tbl</a></span>(<span class="st">"slb"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/tally.html">count</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/pull.html">pull</a></span>(n)</a>
<a class="sourceLine" id="cb18-11" data-line-number="11">)</a>
<a class="sourceLine" id="cb18-12" data-line-number="12"><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(totals)</a>
<a class="sourceLine" id="cb18-13" data-line-number="13"><span class="co">#&gt; [1] 14863825</span></a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#differences-in-taxonomic-concepts">Differences in taxonomic concepts:</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Carl Boettiger, Kari Norman, Jorrit Poelen, Scott Chamberlain.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
